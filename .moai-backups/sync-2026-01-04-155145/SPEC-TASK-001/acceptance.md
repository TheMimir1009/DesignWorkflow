# SPEC-TASK-001: 수락 기준

## 메타데이터

| 항목 | 값 |
|------|-----|
| SPEC ID | SPEC-TASK-001 |
| 관련 SPEC | spec.md, plan.md |
| 작성일 | 2026-01-03 |

---

## 1. 수락 기준 (Acceptance Criteria)

### AC-001: 태스크 생성 모달

**Given** 사용자가 프로젝트를 선택한 상태에서 칸반 보드를 보고 있을 때
**When** `[+ New Task]` 버튼을 클릭하면
**Then** 태스크 생성 모달이 화면 중앙에 열린다

**Given** 태스크 생성 모달이 열려 있을 때
**When** 제목을 입력하지 않은 상태에서
**Then** "생성" 버튼이 비활성화된다

**Given** 태스크 생성 모달에서 제목을 입력했을 때
**When** "생성" 버튼을 클릭하면
**Then** 새 태스크가 Feature List 컬럼에 추가되고 모달이 닫힌다

**Given** 프로젝트에 기본 참조 시스템이 설정되어 있을 때
**When** 새 태스크를 생성하면
**Then** 기본 참조 시스템이 자동으로 태스크에 적용된다

---

### AC-002: 태스크 생성 에러 처리

**Given** 태스크 생성 API 호출 중일 때
**When** 네트워크 오류가 발생하면
**Then** 모달 내에 에러 메시지가 표시되고 모달은 열린 상태를 유지한다

**Given** 프로젝트가 선택되지 않은 상태에서
**When** 태스크 생성을 시도하면
**Then** "프로젝트를 먼저 선택해주세요" 메시지가 표시된다

---

### AC-003: 기능 목록 편집 모달

**Given** 칸반 보드에 태스크 카드가 있을 때
**When** 카드를 클릭하면
**Then** 기능 목록 편집 모달이 열리고 마크다운 에디터가 표시된다

**Given** 기능 목록 편집 모달에서 내용을 수정했을 때
**When** "저장" 버튼을 클릭하면
**Then** 변경 사항이 서버에 저장되고 성공 토스트가 표시된다

**Given** 기능 목록 편집 모달에서 내용을 수정했을 때
**When** "취소" 버튼을 클릭하면
**Then** "변경 사항을 저장하지 않고 닫으시겠습니까?" 확인 다이얼로그가 표시된다

**Given** 기능 목록 편집 모달이 열려 있을 때
**When** ESC 키를 누르면
**Then** 변경 사항이 없으면 모달이 바로 닫히고, 변경 사항이 있으면 확인 다이얼로그가 표시된다

---

### AC-004: 마크다운 에디터 기능

**Given** 기능 목록 편집 모달이 열려 있을 때
**When** 마크다운 문법으로 텍스트를 입력하면
**Then** 입력 내용이 실시간으로 반영된다

**Given** 마크다운 에디터에 내용이 있을 때
**When** 미리보기 탭을 클릭하면 (구현된 경우)
**Then** 마크다운이 렌더링된 결과가 표시된다

---

### AC-005: 태스크 삭제

**Given** 칸반 카드에 삭제 버튼(휴지통 아이콘)이 있을 때
**When** 삭제 버튼을 클릭하면
**Then** "이 태스크를 삭제하시겠습니까?" 확인 다이얼로그가 표시된다

**Given** 삭제 확인 다이얼로그에서
**When** "삭제" 버튼을 클릭하면
**Then** 태스크가 칸반 보드에서 제거되고 "태스크가 삭제되었습니다" 토스트가 표시된다

**Given** AI 문서 생성이 진행 중인 태스크가 있을 때
**When** 해당 태스크의 삭제를 시도하면
**Then** "AI 생성 중인 태스크는 삭제할 수 없습니다" 경고가 표시되고 삭제가 차단된다

---

### AC-006: 참조 시스템 표시

**Given** 태스크에 참조 시스템이 적용되어 있을 때
**When** 태스크 카드 또는 편집 모달을 볼 때
**Then** 적용된 참조 시스템 태그가 표시된다

**Given** 참조 시스템이 3개를 초과할 때
**When** 카드에 표시될 때
**Then** 3개만 표시되고 "+N" 배지가 나타난다

---

### AC-007: 참조 시스템 추가/제거

**Given** 기능 목록 편집 모달이 열려 있을 때
**When** 참조 태그의 "x" 버튼을 클릭하면
**Then** 해당 참조 시스템이 태스크에서 제거된다

**Given** 기능 목록 편집 모달이 열려 있을 때
**When** "+ 추가" 버튼을 클릭하면
**Then** 시스템 문서 검색 드롭다운이 열린다

**Given** 검색 드롭다운에서 시스템을 선택했을 때
**When** 시스템을 클릭하면
**Then** 해당 시스템이 참조로 추가되고 태그로 표시된다

---

## 2. 테스트 시나리오 (Given-When-Then)

### 시나리오 1: 태스크 생성 전체 흐름

```gherkin
Feature: 태스크 생성
  사용자가 새로운 기획 태스크를 생성할 수 있어야 한다

  Background:
    Given 사용자가 "Project Alpha" 프로젝트를 선택했다
    And 프로젝트에 기본 참조 시스템 ["Character", "Combat"]이 설정되어 있다

  Scenario: 성공적인 태스크 생성
    Given 칸반 보드가 표시되어 있다
    When "[+ New Task]" 버튼을 클릭한다
    Then 태스크 생성 모달이 열린다

    When 제목 필드에 "신규 스킬 시스템"을 입력한다
    Then "생성" 버튼이 활성화된다

    When "생성" 버튼을 클릭한다
    Then 모달이 닫힌다
    And Feature List 컬럼에 "신규 스킬 시스템" 카드가 추가된다
    And 카드에 ["Character", "Combat"] 참조 태그가 표시된다

  Scenario: 제목 없이 생성 시도
    Given 태스크 생성 모달이 열려 있다
    When 제목 필드가 비어있는 상태에서
    Then "생성" 버튼이 비활성화되어 있다

    When 제목 필드에 "  " (공백만)을 입력한다
    Then "생성" 버튼이 여전히 비활성화되어 있다
```

### 시나리오 2: 기능 목록 편집

```gherkin
Feature: 기능 목록 편집
  사용자가 태스크의 기능 목록을 마크다운으로 편집할 수 있어야 한다

  Background:
    Given "신규 스킬 시스템" 태스크가 Feature List 컬럼에 있다

  Scenario: 기능 목록 저장
    When 해당 카드를 클릭한다
    Then 기능 목록 편집 모달이 열린다
    And 마크다운 에디터가 표시된다

    When 에디터에 "## 개요\n- 스킬 트리 시스템\n- 액티브/패시브 구분"을 입력한다
    And "저장" 버튼을 클릭한다
    Then "저장되었습니다" 토스트가 표시된다
    And 모달이 닫힌다

  Scenario: 변경 사항 취소 확인
    Given 기능 목록 편집 모달이 열려 있다
    When 에디터에 새 내용을 입력한다
    And "취소" 버튼을 클릭한다
    Then "변경 사항을 저장하지 않고 닫으시겠습니까?" 다이얼로그가 표시된다

    When "닫기" 버튼을 클릭한다
    Then 모달이 닫힌다
    And 변경 사항은 저장되지 않는다
```

### 시나리오 3: 태스크 삭제

```gherkin
Feature: 태스크 삭제
  사용자가 태스크를 삭제할 수 있어야 한다

  Scenario: 태스크 삭제 성공
    Given "테스트 태스크" 카드가 칸반 보드에 있다
    When 카드의 삭제 버튼(휴지통 아이콘)을 클릭한다
    Then 삭제 확인 다이얼로그가 표시된다
    And "테스트 태스크"가 다이얼로그에 표시된다

    When "삭제" 버튼을 클릭한다
    Then 다이얼로그가 닫힌다
    And "태스크가 삭제되었습니다" 토스트가 표시된다
    And 칸반 보드에서 해당 카드가 사라진다

  Scenario: AI 생성 중 태스크 삭제 시도
    Given "AI 생성 중" 인디케이터가 있는 카드가 있다
    When 삭제 버튼을 클릭한다
    Then "AI 생성 중인 태스크는 삭제할 수 없습니다" 메시지가 표시된다
    And 삭제 확인 다이얼로그가 열리지 않는다
```

### 시나리오 4: 참조 시스템 관리

```gherkin
Feature: 참조 시스템 관리
  사용자가 태스크의 참조 시스템을 관리할 수 있어야 한다

  Scenario: 참조 시스템 추가
    Given 기능 목록 편집 모달이 열려 있다
    And 현재 참조 시스템이 ["Character"]뿐이다
    When "+ 추가" 버튼을 클릭한다
    Then 시스템 문서 검색 드롭다운이 열린다

    When "Combat" 시스템을 선택한다
    Then "Combat" 태그가 참조 목록에 추가된다

  Scenario: 참조 시스템 제거
    Given 기능 목록 편집 모달이 열려 있다
    And 참조 시스템 ["Character", "Combat", "Economy"]가 적용되어 있다
    When "Economy" 태그의 "x" 버튼을 클릭한다
    Then "Economy" 태그가 참조 목록에서 제거된다
    And 참조 시스템이 ["Character", "Combat"]로 업데이트된다
```

---

## 3. 품질 게이트 (Quality Gates)

### 3.1 테스트 커버리지

| 구분 | 목표 | 측정 방법 |
|------|------|-----------|
| 단위 테스트 커버리지 | 85% 이상 | vitest --coverage |
| 컴포넌트 테스트 | 모든 주요 인터랙션 | @testing-library/react |
| 통합 테스트 | 핵심 시나리오 5개 이상 | vitest 통합 테스트 |

### 3.2 성능 기준

| 지표 | 목표 | 측정 방법 |
|------|------|-----------|
| 모달 오픈 시간 | 200ms 이내 | Performance API |
| 태스크 생성 API | 1초 이내 | 네트워크 탭 |
| 마크다운 입력 지연 | 50ms 이내 | 체감 테스트 |

### 3.3 접근성 기준

| 항목 | 요구사항 | 검증 방법 |
|------|----------|-----------|
| ARIA 레이블 | 모든 인터랙티브 요소 | axe-core 검사 |
| 키보드 네비게이션 | Tab, ESC, Enter 지원 | 수동 테스트 |
| 포커스 트랩 | 모달 내부 순환 | 수동 테스트 |
| 색상 대비 | WCAG AA 준수 | lighthouse 접근성 검사 |

---

## 4. Definition of Done (완료 정의)

### 4.1 코드 완료 기준

- 모든 컴포넌트 구현 완료
- TypeScript 타입 정의 완료 (any 사용 금지)
- ESLint 경고 0개
- Prettier 포맷팅 적용

### 4.2 테스트 완료 기준

- 단위 테스트 85% 이상 커버리지
- 모든 수락 기준에 대한 테스트 작성
- CI/CD 파이프라인 통과

### 4.3 문서화 기준

- 컴포넌트 Props 인터페이스 JSDoc 주석
- API 엔드포인트 문서화
- 사용 예제 코드 포함

### 4.4 통합 기준

- KanbanBoard와 통합 완료
- 기존 테스트 (SPEC-KANBAN-001) 통과
- 브라우저 호환성 확인 (Chrome, Firefox, Safari)

---

## 5. 검증 방법 및 도구

### 5.1 테스트 도구

| 도구 | 용도 |
|------|------|
| Vitest | 단위/통합 테스트 |
| @testing-library/react | 컴포넌트 테스트 |
| MSW (Mock Service Worker) | API 모킹 |
| axe-core | 접근성 테스트 |

### 5.2 검증 명령어

```bash
# 전체 테스트 실행
npm test

# 커버리지 리포트
npm run test:coverage

# 특정 파일 테스트
npm test -- TaskCreateModal

# 접근성 검사
npm run a11y
```

### 5.3 수동 테스트 체크리스트

- 태스크 생성 후 칸반 보드에 표시 확인
- 마크다운 입력 및 저장 확인
- 삭제 후 카드 제거 확인
- ESC 키로 모달 닫기 확인
- 탭 키로 포커스 이동 확인
- 모바일 반응형 확인 (768px 이하)

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|-----------|
| 1.0 | 2026-01-03 | 초안 작성 |
