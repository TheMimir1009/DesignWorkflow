# SPEC-PROMPT-001: 인수 기준

## 메타데이터

| 항목 | 값 |
|------|-----|
| **SPEC ID** | SPEC-PROMPT-001 |
| **문서 유형** | Acceptance Criteria |
| **생성일** | 2026-01-14 |
| **최종 수정** | 2026-01-14 |

---

## 1. 기능적 인수 기준

### AC-001: 프롬프트 목록 조회

**Given** 사용자가 로그인된 상태이고
**When** 프롬프트 관리 페이지(`/prompts`)에 접근하면
**Then**
- 모든 프롬프트 템플릿이 카테고리별로 그룹화되어 표시된다
- 각 프롬프트 카드에 이름, 설명, 수정 상태 배지가 표시된다
- 카테고리는 접기/펼치기가 가능하다

**검증 방법**: UI 테스트, API 응답 검증

---

### AC-002: 프롬프트 상세 조회

**Given** 프롬프트 목록이 표시된 상태에서
**When** 특정 프롬프트 카드를 클릭하면
**Then**
- 프롬프트 편집기가 해당 프롬프트 내용으로 열린다
- 변수 패널에 사용 가능한 변수 목록이 표시된다
- 프롬프트 내용 중 변수({{...}})가 하이라이팅된다

**검증 방법**: CodeMirror 렌더링 검증, 변수 파싱 테스트

---

### AC-003: 프롬프트 편집 및 저장

**Given** 프롬프트 편집기가 열린 상태에서
**When** 사용자가 프롬프트 내용을 수정하고 저장(Ctrl+S) 버튼을 누르면
**Then**
- 변경된 내용이 서버에 저장된다
- 새로운 버전이 자동으로 생성된다
- 저장 상태 표시기가 "저장됨"으로 변경된다
- 목록에서 해당 프롬프트에 "수정됨" 배지가 표시된다

**검증 방법**: API 호출 검증, 파일 시스템 검증, UI 상태 검증

---

### AC-004: 변수 시스템

**Given** 프롬프트 편집기에서 프롬프트를 작성 중일 때
**When** `{{` 입력 시
**Then**
- 사용 가능한 변수 자동완성 목록이 표시된다
- 변수 선택 시 `{{variableName}}` 형식으로 삽입된다
- 잘못된 변수명 사용 시 경고 표시된다

**검증 방법**: CodeMirror extension 테스트, 변수 검증 로직 테스트

---

### AC-005: 필수 변수 검증

**Given** 프롬프트에 필수 변수가 정의되어 있을 때
**When** 사용자가 필수 변수를 제거하고 저장을 시도하면
**Then**
- 저장이 차단된다
- "필수 변수 누락: {{variableName}}" 오류 메시지가 표시된다
- 누락된 변수 위치가 하이라이팅된다

**검증 방법**: 저장 API 검증, 오류 메시지 표시 검증

---

### AC-006: 버전 히스토리 조회

**Given** 프롬프트 편집기가 열린 상태에서
**When** "버전 히스토리" 버튼을 클릭하면
**Then**
- 해당 프롬프트의 모든 버전 목록이 표시된다
- 각 버전에 버전 번호, 생성 시간, 생성자가 표시된다
- 버전 클릭 시 해당 버전의 내용을 미리볼 수 있다

**검증 방법**: 버전 API 응답 검증, UI 렌더링 검증

---

### AC-007: 버전 비교 (Diff)

**Given** 버전 히스토리가 표시된 상태에서
**When** 두 버전을 선택하고 "비교" 버튼을 클릭하면
**Then**
- 두 버전의 차이점이 diff 형식으로 표시된다
- 추가된 내용은 녹색, 삭제된 내용은 빨간색으로 표시된다

**검증 방법**: Diff 렌더링 검증

---

### AC-008: 기본값 복원

**Given** 수정된 프롬프트가 선택된 상태에서
**When** "기본값 복원" 버튼을 클릭하고 확인 대화상자에서 "확인"을 누르면
**Then**
- 프롬프트가 초기 기본값으로 복원된다
- 현재 내용이 새 버전으로 저장된 후 복원된다
- "수정됨" 배지가 제거된다

**검증 방법**: 복원 API 검증, 버전 생성 검증, UI 상태 검증

---

### AC-009: 저장되지 않은 변경사항 경고

**Given** 프롬프트 편집기에서 변경사항이 저장되지 않은 상태에서
**When** 사용자가 다른 페이지로 이동하거나 브라우저를 닫으려고 하면
**Then**
- "저장되지 않은 변경사항이 있습니다. 페이지를 떠나시겠습니까?" 확인 대화상자가 표시된다
- "취소" 선택 시 현재 페이지에 유지된다
- "확인" 선택 시 변경사항 없이 이동한다

**검증 방법**: beforeunload 이벤트 테스트, 라우터 가드 테스트

---

### AC-010: 프롬프트 미리보기 (Optional)

**Given** 프롬프트 편집기가 열린 상태에서
**When** "미리보기" 버튼을 클릭하면
**Then**
- 샘플 데이터가 변수에 적용된 렌더링 결과가 모달로 표시된다
- 실제 LLM에 전송될 프롬프트 형식을 확인할 수 있다

**검증 방법**: 프리뷰 렌더링 검증, 변수 치환 검증

---

## 2. 비기능적 인수 기준

### NFR-001: 성능

| 항목 | 기준 |
|------|------|
| 프롬프트 목록 로딩 | < 1초 |
| 프롬프트 저장 응답 | < 500ms |
| 에디터 초기 렌더링 | < 500ms |
| 대용량 프롬프트 (50KB) 편집 | 지연 없음 |

---

### NFR-002: 호환성

| 항목 | 기준 |
|------|------|
| 브라우저 | Chrome, Firefox, Safari, Edge 최신 2버전 |
| 반응형 | 최소 너비 768px (태블릿 이상) |
| 기존 기능 | 프롬프트 수정 후에도 문서 생성 기능 정상 동작 |

---

### NFR-003: 안정성

| 항목 | 기준 |
|------|------|
| 자동 저장 | 5초 debounce로 자동 저장 |
| 오류 복구 | 저장 실패 시 자동 재시도 (최대 3회) |
| 데이터 무결성 | 버전 히스토리로 항상 복원 가능 |

---

## 3. 테스트 시나리오

### TS-001: 전체 플로우 테스트

```
1. 프롬프트 관리 페이지 접근
2. "Design Document 생성" 프롬프트 선택
3. 프롬프트 내용 수정 (섹션 추가)
4. 저장 (Ctrl+S)
5. 문서 생성 페이지로 이동
6. Q&A 완료 후 Design Doc 생성
7. 수정된 프롬프트가 적용되었는지 확인
8. 프롬프트 관리 페이지로 돌아가기
9. "기본값 복원" 실행
10. 다시 Design Doc 생성하여 기본값 적용 확인
```

---

### TS-002: 변수 검증 테스트

```
1. "PRD 생성" 프롬프트 선택
2. {{gddContent}} 변수 삭제
3. 저장 시도
4. "필수 변수 누락" 오류 확인
5. 변수 복구
6. 저장 성공 확인
```

---

### TS-003: 버전 관리 테스트

```
1. 프롬프트 선택
2. 내용 수정 및 저장 (v2 생성)
3. 다시 수정 및 저장 (v3 생성)
4. 버전 히스토리 열기
5. v1과 v3 비교 (Diff)
6. v2로 복원
7. 내용이 v2로 변경되었는지 확인
```

---

## 4. 정의 완료 (Definition of Done)

### 4.1 코드 품질

- [ ] TypeScript strict mode 통과
- [ ] ESLint 경고 0개
- [ ] 모든 public 함수에 JSDoc 주석
- [ ] 코드 리뷰 완료

### 4.2 테스트

- [ ] 단위 테스트 커버리지 80% 이상
- [ ] 통합 테스트 통과
- [ ] E2E 테스트 시나리오 완료
- [ ] 기존 테스트 회귀 없음

### 4.3 문서화

- [ ] API 엔드포인트 문서화
- [ ] 컴포넌트 Props 문서화
- [ ] 사용자 가이드 작성

### 4.4 배포

- [ ] 개발 환경 테스트 완료
- [ ] 마이그레이션 스크립트 준비
- [ ] 롤백 계획 수립

---

## 5. 추적성 태그

```
[TAG:SPEC-PROMPT-001]
- acceptance.md (이 문서)
- spec.md (요구사항 명세)
- plan.md (구현 계획)
```

---

## 6. 승인

| 역할 | 승인자 | 날짜 | 상태 |
|------|--------|------|------|
| 제품 담당 | - | - | 대기 |
| 기술 담당 | - | - | 대기 |
| QA 담당 | - | - | 대기 |
