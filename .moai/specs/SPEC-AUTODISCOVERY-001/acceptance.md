# SPEC-AUTODISCOVERY-001: 수용 기준 (Acceptance Criteria)

## 개요

이 문서는 관련 시스템 자동 탐색 기능(SPEC-AUTODISCOVERY-001)의 수용 기준을 Given/When/Then 형식으로 정의합니다.

---

## 1. 핵심 시나리오

### AC-001: 키워드 추출 정확도

**기능**: Feature List 텍스트에서 키워드 추출

```gherkin
시나리오: Feature List에서 의미 있는 키워드를 추출한다

Given: 100자 이상의 Feature List 텍스트가 있을 때
  예시: "캐릭터 성장 시스템 개발. 경험치 획득 시 레벨 상승. 능력치 분배 시스템 추가."

When: 키워드 추출 함수가 실행되면

Then: 3-15개의 의미 있는 키워드가 추출되고
  And: 각 키워드에 가중치(0-100)가 부여되고
  And: 불용어(조사, 접속사 등)는 제외된다
  예시 결과: ["캐릭터", "성장", "경험치", "레벨", "능력치", "분배"]
```

### AC-002: Claude Code 통합 성공

**기능**: Claude Code를 활용한 관련 시스템 판단

```gherkin
시나리오: Claude Code가 관련 시스템을 정확히 판단한다

Given: 추출된 키워드 목록과 프로젝트의 시스템 문서 메타데이터가 있을 때

When: Claude Code를 호출하여 관련 시스템을 판단하면

Then: 최대 5개의 관련 시스템이 반환되고
  And: 각 시스템에 관련도 점수(0-100)가 포함되고
  And: 응답 시간이 5초 이내여야 한다
```

### AC-003: 폴백 추천 작동

**기능**: Claude Code 실패 시 폴백 추천

```gherkin
시나리오: Claude Code 호출 실패 시 키워드 기반 추천을 제공한다

Given: Claude Code 호출이 실패했을 때 (타임아웃 또는 에러)

When: 폴백 로직이 실행되면

Then: 키워드-태그 매칭 기반 추천이 반환되고
  And: 사용자에게 "AI 분석 실패, 키워드 기반 추천" 메시지가 표시된다
```

### AC-004: UI 렌더링 완성

**기능**: 추천 결과 UI 표시

```gherkin
시나리오: 추천 결과가 카드 형태로 표시된다

Given: 추천 시스템 데이터가 있을 때

When: AutoDiscoveryRecommendation 컴포넌트가 렌더링되면

Then: 각 추천 시스템이 카드 형태로 표시되고
  And: 관련도 점수가 프로그레스 바로 시각화되고
  And: "추가" 버튼이 각 카드에 표시된다
```

### AC-005: 개별 시스템 추가

**기능**: 추천 시스템을 참조 목록에 개별 추가

```gherkin
시나리오: 사용자가 추천된 시스템을 참조 목록에 추가한다

Given: 추천 결과에 "Character System"이 표시되어 있을 때

When: 사용자가 "추가" 버튼을 클릭하면

Then: 해당 시스템이 참조 목록에 추가되고
  And: ReferenceTagBar에 새로운 태그가 표시되고
  And: 버튼이 "이미 추가됨"으로 변경된다
```

---

## 2. 일괄 추가 시나리오

### AC-006: 모두 추가 기능

**기능**: 추천된 모든 시스템 일괄 추가

```gherkin
시나리오: 사용자가 모든 추천 시스템을 한 번에 추가한다

Given: 추천 결과에 3개의 시스템이 표시되어 있을 때
  And: 그 중 1개는 이미 참조 목록에 있을 때

When: 사용자가 "모두 추가" 버튼을 클릭하면

Then: 미추가된 2개의 시스템만 참조 목록에 추가되고
  And: 토스트 알림으로 "2개 시스템이 추가되었습니다"가 표시된다
```

---

## 3. 상태별 시나리오

### AC-007: 텍스트 부족 상태

**기능**: Feature List가 너무 짧을 때 안내

```gherkin
시나리오: Feature List가 100자 미만일 때 안내 메시지를 표시한다

Given: Feature List 텍스트가 50자일 때

When: 자동 탐색이 트리거되면

Then: "분석 가능한 충분한 내용이 필요합니다 (최소 100자)" 메시지가 표시되고
  And: 분석이 실행되지 않는다
```

### AC-008: 추천 없음 상태

**기능**: 추천 결과가 없을 때 안내

```gherkin
시나리오: 관련 시스템이 없을 때 안내 메시지를 표시한다

Given: 키워드와 매칭되는 시스템이 없을 때

When: 분석이 완료되면

Then: "추천되는 시스템이 없습니다" 메시지가 표시되고
  And: 수동 검색 안내가 표시된다
```

### AC-009: 로딩 상태

**기능**: 분석 중 로딩 인디케이터 표시

```gherkin
시나리오: 분석 중 로딩 상태를 표시한다

Given: 자동 탐색이 시작되었을 때

When: Claude Code 분석이 진행 중이면

Then: 스켈레톤 UI가 표시되고
  And: "관련 시스템 분석 중..." 메시지가 표시된다
```

---

## 4. 중복 방지 시나리오

### AC-010: 중복 추가 방지

**기능**: 이미 추가된 시스템 중복 방지

```gherkin
시나리오: 이미 참조 목록에 있는 시스템은 추가되지 않는다

Given: "Character System"이 이미 참조 목록에 있을 때
  And: 추천 결과에 "Character System"이 포함되어 있을 때

When: 추천 결과가 렌더링되면

Then: "Character System" 카드의 버튼이 "이미 추가됨"으로 표시되고
  And: 버튼이 비활성화된다
```

---

## 5. 새로고침 시나리오

### AC-011: 재분석 실행

**기능**: 새로고침 버튼으로 재분석

```gherkin
시나리오: 사용자가 재분석을 요청한다

Given: 추천 결과가 표시되어 있을 때

When: 사용자가 "새로고침" 버튼을 클릭하면

Then: 캐시를 무시하고 새로운 분석이 실행되고
  And: 업데이트된 추천 결과가 표시된다
```

---

## 6. 캐싱 시나리오

### AC-012: 캐시 히트

**기능**: 동일 텍스트 캐싱

```gherkin
시나리오: 동일한 Feature List로 재분석 시 캐시를 사용한다

Given: 이전에 분석한 Feature List 텍스트가 동일할 때

When: 자동 탐색이 트리거되면

Then: 캐시된 결과가 200ms 이내에 반환되고
  And: Claude Code 호출이 생략된다
```

---

## 7. 에러 처리 시나리오

### AC-013: API 에러 처리

**기능**: API 호출 실패 시 에러 처리

```gherkin
시나리오: API 호출 실패 시 에러 메시지를 표시한다

Given: 네트워크 오류 또는 서버 오류가 발생했을 때

When: API 호출이 실패하면

Then: "분석에 실패했습니다" 에러 메시지가 표시되고
  And: "다시 시도" 버튼이 표시되고
  And: 폴백 추천이 제공된다 (가능한 경우)
```

---

## 8. 접근성 시나리오

### AC-014: 키보드 네비게이션

**기능**: 키보드로 추천 결과 탐색

```gherkin
시나리오: 키보드로 추천 결과를 탐색하고 추가한다

Given: 추천 결과가 표시되어 있을 때

When: 사용자가 Tab 키로 이동하고 Enter를 누르면

Then: 포커스된 시스템이 참조 목록에 추가된다
```

---

## 9. 성능 시나리오

### AC-015: 응답 시간 준수

**기능**: 성능 요구사항 충족

```gherkin
시나리오: 분석 응답 시간이 요구사항을 충족한다

Given: 100자 이상의 Feature List 텍스트가 있을 때

When: 자동 탐색이 실행되면

Then: 캐시 미스 시 5초 이내에 응답하고
  And: 캐시 히트 시 200ms 이내에 응답한다
```

---

## 10. 프로젝트 격리 시나리오

### AC-016: 프로젝트별 데이터 격리

**기능**: 현재 프로젝트 시스템만 추천

```gherkin
시나리오: 현재 프로젝트의 시스템만 추천한다

Given: 프로젝트 A에 10개, 프로젝트 B에 5개의 시스템이 있고
  And: 현재 프로젝트 A가 선택되어 있을 때

When: 자동 탐색이 실행되면

Then: 프로젝트 A의 시스템만 추천 결과에 포함되고
  And: 프로젝트 B의 시스템은 추천되지 않는다
```

---

## 11. 테스트 요약

| AC ID | 기능 | 우선순위 | 자동화 |
|-------|------|----------|--------|
| AC-001 | 키워드 추출 정확도 | 필수 | 가능 |
| AC-002 | Claude Code 통합 | 필수 | 가능 |
| AC-003 | 폴백 추천 | 필수 | 가능 |
| AC-004 | UI 렌더링 | 필수 | 가능 |
| AC-005 | 개별 시스템 추가 | 필수 | 가능 |
| AC-006 | 모두 추가 | 필수 | 가능 |
| AC-007 | 텍스트 부족 상태 | 필수 | 가능 |
| AC-008 | 추천 없음 상태 | 필수 | 가능 |
| AC-009 | 로딩 상태 | 필수 | 가능 |
| AC-010 | 중복 추가 방지 | 필수 | 가능 |
| AC-011 | 재분석 실행 | 권장 | 가능 |
| AC-012 | 캐시 히트 | 권장 | 가능 |
| AC-013 | API 에러 처리 | 필수 | 가능 |
| AC-014 | 키보드 네비게이션 | 권장 | 가능 |
| AC-015 | 응답 시간 준수 | 필수 | 가능 |
| AC-016 | 프로젝트 격리 | 필수 | 가능 |

---

## 12. 테스트 커버리지 목표

- **필수 AC 통과율**: 100%
- **권장 AC 통과율**: 80% 이상
- **코드 커버리지**: 85% 이상
- **E2E 테스트**: 핵심 플로우 100% 커버
