# SPEC-ARCHIVE-001: 수용 기준 (Acceptance Criteria)

## 개요

이 문서는 아카이브 기능(SPEC-ARCHIVE-001)의 수용 기준을 Given/When/Then 형식으로 정의합니다.

---

## 1. 핵심 시나리오

### AC-001: 태스크 아카이브

**기능**: Prototype 상태의 태스크를 아카이브

```gherkin
시나리오: 사용자가 완료된 태스크를 아카이브한다

Given: 태스크가 Prototype 컬럼에 존재하고
  And: 태스크에 모든 문서(Feature List, Design Doc, PRD, Prototype)가 있고
  And: 사용자가 해당 프로젝트에 접근 권한이 있을 때

When: 사용자가 칸반 카드의 "아카이브" 버튼을 클릭하고
  And: 확인 다이얼로그에서 "아카이브" 버튼을 클릭하면

Then: 태스크가 칸반 보드에서 사라지고
  And: 아카이브 목록에 태스크가 추가되고
  And: 태스크의 isArchived 플래그가 true로 설정되고
  And: 모든 문서 데이터가 아카이브 저장소에 보존되고
  And: 성공 토스트 메시지가 표시된다
```

### AC-002: 아카이브 목록 조회

**기능**: 프로젝트의 아카이브된 태스크 목록 조회

```gherkin
시나리오: 사용자가 아카이브 목록을 조회한다

Given: 프로젝트에 3개의 아카이브된 태스크가 있고
  And: 각 태스크가 서로 다른 날짜에 아카이브되었을 때

When: 사용자가 "아카이브" 메뉴를 클릭하면

Then: 아카이브 목록 뷰가 표시되고
  And: 3개의 아카이브된 태스크가 표시되고
  And: 목록이 아카이브 날짜 기준 최신순으로 정렬되고
  And: 각 항목에 태스크 제목, 아카이브 날짜가 표시된다
```

### AC-003: 아카이브 상세 조회

**기능**: 아카이브된 태스크의 모든 문서 조회

```gherkin
시나리오: 사용자가 아카이브된 태스크의 상세 내용을 조회한다

Given: 아카이브된 태스크가 있고
  And: 태스크에 Feature List, Design Doc, PRD, Prototype 문서가 있을 때

When: 사용자가 아카이브 목록에서 해당 태스크를 클릭하면

Then: 아카이브 상세 뷰가 모달/패널로 열리고
  And: 4개의 탭(Feature List, Design Doc, PRD, Prototype)이 표시되고
  And: 각 탭에서 해당 문서의 Markdown 내용이 렌더링되고
  And: 복원 버튼이 표시된다
```

### AC-004: 아카이브 복원

**기능**: 아카이브된 태스크를 칸반 보드로 복원

```gherkin
시나리오: 사용자가 아카이브된 태스크를 복원한다

Given: 아카이브된 태스크가 있고
  And: 사용자가 아카이브 상세 뷰를 보고 있을 때

When: 사용자가 "복원" 버튼을 클릭하고
  And: 확인 다이얼로그에서 "복원" 버튼을 클릭하면

Then: 태스크가 Prototype 컬럼에 다시 나타나고
  And: 아카이브 목록에서 해당 태스크가 제거되고
  And: 태스크의 isArchived 플래그가 false로 설정되고
  And: 모든 문서 데이터가 원래대로 복원되고
  And: 성공 토스트 메시지가 표시된다
```

### AC-005: 비-Prototype 태스크 아카이브 방지

**기능**: Prototype이 아닌 상태의 태스크에서 아카이브 방지

```gherkin
시나리오: Prototype이 아닌 태스크에서 아카이브 버튼이 표시되지 않는다

Given: 태스크가 "featurelist" 상태일 때
When: 사용자가 해당 칸반 카드를 확인하면
Then: "아카이브" 버튼이 표시되지 않는다

Given: 태스크가 "design" 상태일 때
When: 사용자가 해당 칸반 카드를 확인하면
Then: "아카이브" 버튼이 표시되지 않는다

Given: 태스크가 "prd" 상태일 때
When: 사용자가 해당 칸반 카드를 확인하면
Then: "아카이브" 버튼이 표시되지 않는다

Given: 태스크가 "prototype" 상태일 때
When: 사용자가 해당 칸반 카드를 확인하면
Then: "아카이브" 버튼이 표시된다
```

---

## 2. 검색 및 필터링 시나리오

### AC-006: 아카이브 검색

**기능**: 아카이브 목록에서 키워드 검색

```gherkin
시나리오: 사용자가 아카이브 목록에서 키워드로 검색한다

Given: 5개의 아카이브된 태스크가 있고
  And: 그 중 2개의 태스크 제목에 "전투" 키워드가 포함되어 있을 때

When: 사용자가 검색 입력 필드에 "전투"를 입력하면

Then: 검색 결과로 2개의 태스크만 표시되고
  And: 나머지 3개의 태스크는 목록에서 숨겨진다
```

### AC-007: 빈 아카이브 목록

**기능**: 아카이브된 태스크가 없을 때 빈 상태 표시

```gherkin
시나리오: 아카이브된 태스크가 없을 때 빈 상태 메시지를 표시한다

Given: 프로젝트에 아카이브된 태스크가 없을 때

When: 사용자가 아카이브 메뉴를 클릭하면

Then: "아카이브된 태스크가 없습니다" 메시지가 표시되고
  And: 빈 상태 아이콘/일러스트레이션이 표시된다
```

---

## 3. 에러 처리 시나리오

### AC-008: 아카이브 실패 처리

**기능**: 아카이브 작업 실패 시 에러 처리

```gherkin
시나리오: 서버 오류로 아카이브가 실패했을 때 에러를 처리한다

Given: 태스크가 Prototype 컬럼에 있고
  And: 서버에 일시적인 오류가 있을 때

When: 사용자가 "아카이브" 버튼을 클릭하고 확인하면

Then: 에러 토스트 메시지가 표시되고
  And: 태스크가 칸반 보드에 그대로 유지되고
  And: 아카이브 목록에 태스크가 추가되지 않는다
```

### AC-009: 복원 실패 처리

**기능**: 복원 작업 실패 시 에러 처리

```gherkin
시나리오: 서버 오류로 복원이 실패했을 때 에러를 처리한다

Given: 아카이브된 태스크가 있고
  And: 서버에 일시적인 오류가 있을 때

When: 사용자가 "복원" 버튼을 클릭하고 확인하면

Then: 에러 토스트 메시지가 표시되고
  And: 태스크가 아카이브 목록에 그대로 유지되고
  And: 칸반 보드에 태스크가 추가되지 않는다
```

---

## 4. 삭제 시나리오

### AC-010: 아카이브 영구 삭제

**기능**: 아카이브된 태스크 영구 삭제

```gherkin
시나리오: 사용자가 아카이브된 태스크를 영구 삭제한다

Given: 아카이브된 태스크가 있고
  And: 사용자가 삭제 권한이 있을 때

When: 사용자가 "삭제" 버튼을 클릭하고
  And: 확인 다이얼로그에서 "삭제" 버튼을 클릭하면

Then: 아카이브 목록에서 태스크가 제거되고
  And: 모든 관련 문서 데이터가 영구 삭제되고
  And: 성공 토스트 메시지가 표시된다
```

### AC-011: 삭제 취소

**기능**: 삭제 확인 다이얼로그에서 취소

```gherkin
시나리오: 사용자가 삭제 확인 다이얼로그에서 취소한다

Given: 아카이브된 태스크가 있고
  And: 삭제 확인 다이얼로그가 표시되어 있을 때

When: 사용자가 "취소" 버튼을 클릭하면

Then: 다이얼로그가 닫히고
  And: 태스크가 아카이브 목록에 그대로 유지되고
  And: 어떤 데이터도 삭제되지 않는다
```

---

## 5. 데이터 무결성 시나리오

### AC-012: 문서 데이터 보존

**기능**: 아카이브 시 모든 문서 데이터 보존 확인

```gherkin
시나리오: 아카이브된 태스크의 모든 문서가 원본과 동일하게 보존된다

Given: 태스크가 다음 문서를 포함하고 있을 때:
  | 문서 타입       | 내용 길이 |
  | Feature List   | 500자    |
  | Design Doc     | 2000자   |
  | PRD            | 1500자   |
  | Prototype      | 1000자   |

When: 사용자가 태스크를 아카이브하고
  And: 아카이브 상세 뷰에서 각 문서를 확인하면

Then: 각 문서의 내용이 원본과 완전히 동일하고
  And: 문서 길이가 변경되지 않았고
  And: Markdown 서식이 그대로 유지된다
```

### AC-013: 복원 후 데이터 무결성

**기능**: 복원된 태스크의 데이터 무결성 확인

```gherkin
시나리오: 복원된 태스크가 아카이브 전과 동일한 데이터를 가진다

Given: 아카이브된 태스크가 있고
  And: 태스크가 특정 문서 내용과 참조 시스템을 가지고 있을 때

When: 사용자가 태스크를 복원하고
  And: 칸반 카드에서 태스크 상세를 확인하면

Then: 모든 문서 내용이 아카이브 전과 동일하고
  And: 참조 시스템 목록이 그대로 유지되고
  And: 태스크 메타데이터(제목, 생성일 등)가 보존된다
```

---

## 6. UI/UX 시나리오

### AC-014: 아카이브 버튼 위치

**기능**: 아카이브 버튼이 적절한 위치에 표시

```gherkin
시나리오: Prototype 카드에서 아카이브 버튼이 올바른 위치에 표시된다

Given: 태스크가 Prototype 컬럼에 있을 때

When: 사용자가 칸반 카드를 확인하면

Then: 아카이브 버튼이 카드 우측 상단에 표시되고
  And: 버튼에 아카이브 아이콘이 포함되고
  And: 버튼 호버 시 툴팁 "아카이브"가 표시된다
```

### AC-015: 로딩 상태 표시

**기능**: 아카이브 작업 중 로딩 상태 표시

```gherkin
시나리오: 아카이브 작업 중 로딩 인디케이터가 표시된다

Given: 사용자가 아카이브를 확인했을 때

When: 서버에서 응답을 기다리는 동안

Then: 아카이브 버튼이 비활성화되고
  And: 로딩 스피너가 표시되고
  And: 작업 완료 후 정상 상태로 돌아온다
```

---

## 7. 테스트 요약

| AC ID | 기능 | 우선순위 | 자동화 |
|-------|------|----------|--------|
| AC-001 | 태스크 아카이브 | 필수 | 가능 |
| AC-002 | 목록 조회 | 필수 | 가능 |
| AC-003 | 상세 조회 | 필수 | 가능 |
| AC-004 | 아카이브 복원 | 필수 | 가능 |
| AC-005 | 비-Prototype 방지 | 필수 | 가능 |
| AC-006 | 검색 | 권장 | 가능 |
| AC-007 | 빈 상태 | 권장 | 가능 |
| AC-008 | 아카이브 실패 | 필수 | 가능 |
| AC-009 | 복원 실패 | 필수 | 가능 |
| AC-010 | 영구 삭제 | 권장 | 가능 |
| AC-011 | 삭제 취소 | 권장 | 가능 |
| AC-012 | 문서 보존 | 필수 | 가능 |
| AC-013 | 복원 무결성 | 필수 | 가능 |
| AC-014 | 버튼 위치 | 권장 | 가능 |
| AC-015 | 로딩 상태 | 권장 | 가능 |

---

## 8. 테스트 커버리지 목표

- **필수 AC 통과율**: 100%
- **권장 AC 통과율**: 80% 이상
- **코드 커버리지**: 85% 이상
- **E2E 테스트**: 핵심 플로우 100% 커버
