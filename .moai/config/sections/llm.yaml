# LLM Configuration Settings
# Multi-LLM routing for cost-effective development workflows
# Reference: Multi-LLM Parallel Development Automation Plan

llm:
  # LLM Mode Selection
  # - claude-only: Use Claude for all phases (Opus/Sonnet based on pricing plan)
  # - mashup: Plan with Claude, Run/Sync with GLM (balanced)
  # - glm-only: Use GLM for all phases (lowest cost)
  mode: mashup

  # Auto worktree settings
  # When hybrid mode is enabled, automatically create worktree with GLM config
  auto_worktree:
    enabled: true           # Enable auto-worktree for hybrid mode
    copy_glm_config: true   # Copy GLM settings.local.json to worktree

  # GLM API Configuration
  # IMPORTANT: Claude Code settings.local.json does NOT support ${ENV_VAR} interpolation
  # The API key must be directly specified in .moai/llm-configs/glm.json
  # This is a Claude Code limitation - env section only SETs variables, not reads them
  glm:
    base_url: "https://api.z.ai/api/anthropic"
    # API key is configured directly in .moai/llm-configs/glm.json
    # To update the key: edit glm.json and recreate worktrees
    models:
      haiku: "glm-4.7"
      sonnet: "glm-4.7"
      opus: "glm-4.7"

  # Routing behavior
  routing:
    # Auto-detect complexity and route accordingly
    auto_detect: true

    # Threshold for parallel SPEC decomposition
    # If estimated tasks > threshold, decompose into multiple SPECs
    parallel_threshold: 5

    # Always ask before creating worktree (when hybrid mode)
    confirm_worktree: false
